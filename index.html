<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>DETAILGUY317 Garage</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
  font-family:'Poppins',system-ui,Segoe UI,Roboto,Arial;
  color:#f3f6fb;
  background:#060b14;
  overflow:hidden;
  padding-top:98px;
}

.ticker-container{
  position:fixed;
  top:0;left:0;right:0;
  height:60px;
  background:rgba(10,10,10,0.95);
  border-bottom:2px solid #ff6600;
  display:flex;
  align-items:center;
  z-index:110;
  opacity:0;
  animation:fadeInTicker 2s ease-in-out 10s forwards;
}
@keyframes fadeInTicker{
  from{opacity:0;}
  to{opacity:1;}
}
.ticker-wrapper{
  flex:1;
  height:60px;
}
.ticker-wrapper iframe{
  width:100%;
  height:60px;
  border:none;
}
.ticker-btn{
  padding:10px 18px;
  margin:0 12px;
  background:#ff6600;
  border:none;
  border-radius:8px;
  color:#fff;
  font-weight:600;
  font-size:14px;
  cursor:pointer;
  white-space:nowrap;
  transition:.3s;
  box-shadow:0 0 15px rgba(255,102,0,0.4);
}
.ticker-btn:hover{
  background:#ff7f2a;
  box-shadow:0 0 20px rgba(255,102,0,0.7);
  transform:scale(1.05);
}

.auto-news-ticker {
  position:fixed;
  top:60px; left:0; right:0;
  width:100%;
  background:rgba(10,10,10,0.96);
  border-bottom:2px solid #ff6600;
  font-size:18px;
  font-weight:600;
  color:#ffe6cc;
  height:38px;
  display:flex; align-items:center; overflow:hidden;
  z-index:109;
}
.auto-ticker-inner {
  white-space:nowrap;
  will-change:transform;
  animation:autoNewsScroll 38s linear infinite;
  padding-left:100vw;
  display:block;
  width:auto;
}
@keyframes autoNewsScroll {
  0%   { transform: translateX(0);}
  100% { transform: translateX(-100vw);}
}

/* Background image */
#background{
  position:fixed;inset:0;
  background:url("./webback.jpg") center/cover no-repeat;
  filter:brightness(1.15) contrast(1.05);
  animation:scrollBg 12s ease-out forwards;
  z-index:0;
}
@keyframes scrollBg{
  from{background-position:center 200px;}
  to{background-position:center -180px;}
}

.overlay{
  position:fixed;top:98px;left:50%;
  transform:translateX(-50%);
  text-align:center;z-index:3;
  perspective:800px;
}
.overlay h1{
  font-size:64px;font-weight:800;
  color:#ff6a00;letter-spacing:4px;
  text-shadow:0 0 30px rgba(255,106,0,1);
  transform:rotateX(15deg) translateZ(30px);
  animation:pulse3D 6s ease-in-out infinite;
}
.overlay p{
  margin-top:8px;font-size:24px;
  color:#ffe6cc;text-shadow:0 0 12px rgba(255,106,0,0.9);
  transform:rotateX(10deg) translateZ(10px);
  animation:pulse3DSoft 6s ease-in-out infinite;
}
@keyframes pulse3D{
  0%,100%{transform:rotateX(15deg) translateZ(30px) scale(1);}
  50%{transform:rotateX(5deg) translateZ(60px) scale(1.1);}
}
@keyframes pulse3DSoft{
  0%,100%{transform:rotateX(10deg) translateZ(10px) scale(1);}
  50%{transform:rotateX(5deg) translateZ(25px) scale(1.05);}
}

.icon-row{
  position:fixed;
  bottom:0;left:50%;
  transform:translateX(-50%);
  display:flex;gap:1.5rem;
  z-index:2;padding-bottom:12px;
}
.icon{
  min-width:130px;height:58px;
  background:linear-gradient(145deg,#ff6a00,#ff3b00);
  border-radius:40px;
  box-shadow:0 0 15px rgba(255,102,0,0.5);
  display:flex;align-items:center;justify-content:center;
  color:#fff;font-weight:600;letter-spacing:1px;
  cursor:pointer;transition:all .35s ease;
}
.icon:hover{
  transform:translateY(-8px) scale(1.05);
  box-shadow:0 0 25px #ff6600,0 0 40px rgba(255,102,0,0.5);
}

.search-bar{
  position:fixed;right:40px;bottom:40px;
  width:320px;
  background:rgba(20,20,20,0.95);
  color:#fff;border:1px solid #ff6600;
  border-radius:14px;padding:14px 18px;
  box-shadow:0 0 25px rgba(255,102,0,0.3);
  z-index:4;
}

.vin-box{
  position:fixed;left:40px;bottom:40px;
  width:360px;
  background:rgba(20,20,20,0.95);
  color:#fff;border:1px solid #ff6600;
  border-radius:14px;padding:14px 18px;
  box-shadow:0 0 25px rgba(255,102,0,0.3);
  z-index:4;
}

.search-bar label{
  font-weight:600;font-size:1.05em;
  color:#ff7f2a;margin-bottom:9px;
  text-align:center;display:block;
}
.vin-box label{
  font-weight:600;font-size:1.05em;
  color:#ff7f2a;margin-bottom:9px;
  text-align:center;display:block;
}

.search-bar input, .vin-box input{
  width:100%;padding:10px;
  border-radius:8px;background:#111;color:#fff;
  border:1px solid #555;margin-bottom:8px;outline:none;
}
.vin-box input{text-transform:uppercase;}

.search-bar button, .vin-box button{
  width:100%;padding:10px;border-radius:8px;
  border:none;background:#ff6600;color:#fff;
  cursor:pointer;font-size:1.05em;font-weight:600;
  transition:.3s;
}
.search-bar button:hover, .vin-box button:hover{
  background:#ff7f2a;
  box-shadow:0 0 20px rgba(255,102,0,0.6);
}

.faq-response{
  background:#222;color:#fff;padding:8px;
  border-radius:6px;font-size:.95em;
  text-align:center;margin-top:8px;min-height:18px;
}
.vin-response{
  background:#222;color:#fff;padding:12px;
  border-radius:6px;font-size:.95em;
  text-align:left;margin-top:8px;min-height:18px;
  max-height:500px;overflow-y:auto;
  transition:all 0.3s ease;
  position:relative;
}
.vin-response.collapsed{
  max-height:45px;
  overflow:hidden;
  cursor:pointer;
}
.vin-response.collapsed:hover{
  background:#2a2a2a;
  border:1px solid #ff6600;
}
.vin-close-btn{
  position:absolute;
  top:8px;
  right:8px;
  background:#ff6600;
  color:#fff;
  width:24px;
  height:24px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  font-size:16px;
  font-weight:bold;
  transition:.3s;
  z-index:10;
}
.vin-close-btn:hover{
  background:#ff7f2a;
  transform:scale(1.1);
}
.vin-response.collapsed .vin-close-btn{
  display:none;
}
.vin-response h3{
  color:#ff7f2a;margin-bottom:8px;font-size:1.1em;
}
.vin-response .vehicle-info{
  background:#1a1a1a;padding:12px;
  border-left:3px solid #4ade80;
  margin-bottom:12px;border-radius:4px;
}
.vin-response .vehicle-info strong{
  color:#4ade80;
}
.vin-response .recall-item{
  background:#1a1a1a;padding:10px;
  border-left:3px solid #ff6600;
  margin-bottom:10px;border-radius:4px;
}
.vin-response .no-recall{
  color:#4ade80;font-weight:600;
  text-align:center;padding:10px;
  font-size:1.1em;
}
.vin-response .warning{
  color:#fbbf24;font-weight:600;
  background:#2a2008;
  padding:10px;
  border-radius:6px;
  text-align:center;
  margin-bottom:12px;
}
.vin-response button{
  width:100%;padding:8px;margin-top:8px;
  border-radius:6px;border:none;
  background:#ff6600;color:#fff;
  cursor:pointer;font-weight:600;
  transition:.3s;
  font-size:.9em;
}
.vin-response button:hover{
  background:#ff7f2a;
  box-shadow:0 0 15px rgba(255,102,0,0.5);
}
.vin-response .button-row{
  display:flex;gap:8px;margin-top:8px;
}
.vin-response .button-row button{
  flex:1;font-size:.85em;
  padding:10px 6px;
}

footer{
  margin-top:8px;font-size:.8rem;
  color:#aaa;text-align:right;
}

/* Modal Styles */
.stock-modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.85);
  z-index: 1000;
  overflow-y: auto;
  padding: 20px;
}

.stock-modal.show {
  display: block;
}

.modal-content {
  background: #1a1a1a;
  max-width: 900px;
  margin: 40px auto;
  padding: 30px;
  border-radius: 15px;
  border: 2px solid #ff6600;
  position: relative;
  box-shadow: 0 0 40px rgba(255, 102, 0, 0.4);
}

.close-btn {
  position: absolute;
  top: 15px;
  right: 20px;
  font-size: 28px;
  color: #ff6600;
  cursor: pointer;
  font-weight: bold;
  transition: .3s;
}

.close-btn:hover {
  color: #ff7f2a;
  transform: scale(1.2);
}

.modal-content h2 {
  color: #ff6600;
  margin-bottom: 20px;
  text-align: center;
  font-size: 2em;
}

.modal-content button {
  display: block;
  width: 100%;
  padding: 12px;
  margin: 8px 0;
  background: #ff6600;
  border: none;
  border-radius: 8px;
  color: #fff;
  font-weight: 600;
  cursor: pointer;
  transition: .3s;
  text-align: left;
}

.modal-content button:hover {
  background: #ff7f2a;
  box-shadow: 0 0 20px rgba(255,102,0,0.6);
  transform: translateX(5px);
}

.modal-content h3 {
  color: #ff7f2a;
  margin: 20px 0 10px 0;
  font-size: 1.2em;
}

.modal-content iframe {
  display: block;
  margin: 0 auto;
  border: 2px solid #ff6600;
  border-radius: 8px;
}
</style>
</head>
<body>
  <div id="background"></div>
  <div class="ticker-container">
    <div class="ticker-wrapper">
      <iframe src="https://www.tradingview.com/embed-widget/ticker-tape/?locale=en#%7B%22symbols%22%3A%5B%7B%22proName%22%3A%22NASDAQ%3ATSLA%22%2C%22title%22%3A%22Tesla%22%7D%2C%7B%22proName%22%3A%22NYSE%3AF%22%2C%22title%22%3A%22Ford%22%7D%2C%7B%22proName%22%3A%22NYSE%3AGM%22%2C%22title%22%3A%22GM%22%7D%2C%7B%22proName%22%3A%22NYSE%3ATM%22%2C%22title%22%3A%22Toyota%22%7D%2C%7B%22proName%22%3A%22NYSE%3ASTLA%22%2C%22title%22%3A%22Stellantis%22%7D%2C%7B%22proName%22%3A%22NYSE%3AHMC%22%2C%22title%22%3A%22Honda%22%7D%2C%7B%22proName%22%3A%22NYSE%3ARACE%22%2C%22title%22%3A%22Ferrari%22%7D%2C%7B%22proName%22%3A%22NASDAQ%3ARIVN%22%2C%22title%22%3A%22Rivian%22%7D%2C%7B%22proName%22%3A%22NASDAQ%3ALCID%22%2C%22title%22%3A%22Lucid%22%7D%2C%7B%22proName%22%3A%22NYSE%3ANIO%22%2C%22title%22%3A%22NIO%22%7D%2C%7B%22proName%22%3A%22NYSE%3AXPEV%22%2C%22title%22%3A%22XPeng%22%7D%2C%7B%22proName%22%3A%22NASDAQ%3ALI%22%2C%22title%22%3A%22Li%20Auto%22%7D%2C%7B%22proName%22%3A%22NASDAQ%3AGT%22%2C%22title%22%3A%22Goodyear%22%7D%2C%7B%22proName%22%3A%22NYSE%3ABWA%22%2C%22title%22%3A%22BorgWarner%22%7D%2C%7B%22proName%22%3A%22NYSE%3AAPTV%22%2C%22title%22%3A%22Aptiv%22%7D%2C%7B%22proName%22%3A%22NYSE%3ALEA%22%2C%22title%22%3A%22Lear%22%7D%2C%7B%22proName%22%3A%22NASDAQ%3AVC%22%2C%22title%22%3A%22Visteon%22%7D%2C%7B%22proName%22%3A%22NYSE%3AALV%22%2C%22title%22%3A%22Autoliv%22%7D%5D%2C%22showSymbolLogo%22%3Atrue%2C%22colorTheme%22%3A%22dark%22%2C%22isTransparent%22%3Atrue%2C%22displayMode%22%3A%22adaptive%22%2C%22width%22%3A%22100%25%22%2C%22height%22%3A60%2C%22utm_source%22%3A%22detailguy317.com%22%2C%22utm_medium%22%3A%22widget%22%2C%22utm_campaign%22%3A%22ticker-tape%22%7D" frameborder="0" allowtransparency="true" scrolling="no"></iframe>
    </div>
    <button class="ticker-btn" onclick="toggleStockModal()">üìä View Stocks</button>
  </div>
  <div class="auto-news-ticker" id="autoNewsTicker">
    <div class="auto-ticker-inner" id="autoTickerInner">Loading automotive news...</div>
  </div>
  <div class="overlay">
    <h1>DETAILGUY317 Garage</h1>
    <p>Racing / Automotive News and Information</p>
  </div>
  <div class="icon-row">
    <div class="icon" id="estore">E-Store</div>
    <div class="icon" id="racing" onclick="toggleRacingModal()">Racing</div>
    <div class="icon" id="auto" onclick="toggleAutoInfoModal()">Auto Info</div>
    <div class="icon" id="extra">TBD</div>
  </div>
  <div class="vin-box">
    <label>Enter VIN Here for FREE Recall Check</label>
    <input type="text" placeholder="Enter 17-digit VIN..." id="vinInput" maxlength="17" />
    <button onclick="handleVIN()">Check Recalls</button>
    <div class="vin-response" id="vin-response"></div>
  </div>
  <div class="search-bar">
    <label>Ask A Car Question or Enter Trouble Code </label>
    <input type="text" placeholder="Type your car question or DTC..." id="queryInput" />
    <button onclick="handleSearch()">Get Answer</button>
    <div class="faq-response" id="faq-response"></div>
    <footer>¬© 2025 DetailGuy317.com | Made in U.S.A. by carguy for carfolks </footer>
  </div>

<!-- Stock Modal -->
<div class="stock-modal" id="stockModal">
  <div class="modal-content">
    <span class="close-btn" onclick="toggleStockModal()">‚úñ</span>
    <h2>üìä Stock Information</h2>
    <p style="color: #fff; text-align: center;">Your stock content goes here</p>
  </div>
</div>

<!-- Racing Modal -->
<div class="stock-modal" id="racingModal">
  <div class="modal-content">
    <span class="close-btn" onclick="toggleRacingModal()">‚úñ</span>
    <h2>üèÅ Racing Videos & Content</h2>
    
    <div style="margin: 20px 0;">
      <h3>Featured Video</h3>
      <iframe width="560" height="315" 
        src="https://www.youtube.com/embed/LXb3EKWsInQ" 
        title="YouTube video player" 
        frameborder="0" 
        allowfullscreen>
      </iframe>
    </div>
    
    <div style="margin: 20px 0;">
      <h3>Racing Links</h3>
      <button onclick="openLink('https://www.youtube.com/@FordPerformance')">üèéÔ∏è Ford Performance Channel</button>
      <button onclick="openLink('https://www.youtube.com/results?search_query=mustang+racing')">üêé Mustang Racing Videos</button>
      <button onclick="openLink('https://www.nascar.com')">üèÅ NASCAR Official</button>
      <button onclick="openLink('https://www.imsa.com')">üèÜ IMSA Racing</button>
      <button onclick="openLink('https://www.youtube.com/@NHRA')">üî• NHRA Drag Racing</button>
    </div>
  </div>
</div>

<!-- Auto Info Modal -->
<div class="stock-modal" id="autoInfoModal">
  <div class="modal-content">
    <span class="close-btn" onclick="toggleAutoInfoModal()">‚úñ</span>
    <h2>üîß Automotive Information</h2>
    
    <div style="margin: 20px 0;">
      <h3>Favorite Auto News & Reviews</h3>
      <button onclick="openLink('https://www.motortrend.com')">üì∞ MotorTrend</button>
      <button onclick="openLink('https://www.caranddriver.com')">üöó Car and Driver</button>
      <button onclick="openLink('https://www.hagerty.com')">üèõÔ∏è Hagerty</button>
      <button onclick="openLink('https://www.thedrive.com')">üõ£Ô∏è The Drive</button>
      <button onclick="openLink('https://www.roadandtrack.com')">üèéÔ∏è Road & Track</button>
    </div>
    
    <div style="margin: 20px 0;">
      <h3>Technical Resources</h3>
      <button onclick="openLink('https://www.alldata.com')">üîß ALLDATA</button>
      <button onclick="openLink('https://www.identifix.com')">üõ†Ô∏è Identifix</button>
      <button onclick="openLink('https://www.rockauto.com')">üî© RockAuto Parts</button>
      <button onclick="openLink('https://www.summitracing.com')">‚öôÔ∏è Summit Racing</button>
    </div>
    
    <div style="margin: 20px 0;">
      <h3>Ford Enthusiast Sites</h3>
      <button onclick="openLink('https://www.fordperformance.com')">‚ö° Ford Performance</button>
      <button onclick="openLink('https://www.mustang6g.com')">üêé Mustang6G Forum</button>
      <button onclick="openLink('https://www.bronco6g.com')">üèîÔ∏è Bronco6G Forum</button>
    </div>
  </div>
</div>

<script>
function toggleStockModal(){
  document.getElementById('stockModal').classList.toggle('show');
}

function toggleRacingModal(){
  document.getElementById('racingModal').classList.toggle('show');
}

function toggleAutoInfoModal(){
  document.getElementById('autoInfoModal').classList.toggle('show');
}

function openLink(url){
  window.open(url,'_blank');
}

function handleSearch(){
  const query=document.getElementById('queryInput').value.trim();
  const response=document.getElementById('faq-response');
  if(!query){
    response.textContent="Please enter a question or code!";
    return;
  }
  response.textContent="You asked: "+query+" (Demo response ‚Äî AI integration coming soon)";
}

function handleVIN(){
  const vin=document.getElementById('vinInput').value.trim().toUpperCase();
  const response=document.getElementById('vin-response');

  if(!vin){
    response.innerHTML="<div style='text-align:center'>Please enter a VIN!</div>";
    return;
  }

  if(vin.length!==17){
    response.innerHTML="<div style='text-align:center'>VIN must be exactly 17 characters!</div>";
    return;
  }

  response.innerHTML="<div style='text-align:center'>üîç Checking NHTSA database...</div>";
  
  // Fetch vehicle info AND recalls from NHTSA API
  Promise.all([
    fetch(`https://vpic.nhtsa.dot.gov/api/vehicles/DecodeVin/${vin}?format=json`).then(res=>res.json()),
    fetch(`https://api.nhtsa.gov/recalls/recallsByVehicle?vin=${vin}`).then(res=>res.json())
  ])
  .then(([vehicleData, recallData])=>{
    displayResults(vin, vehicleData, recallData);
  })
  .catch(err=>{
    response.innerHTML="<div style='text-align:center;color:#ef4444'>Error connecting to NHTSA. Please try again.</div>";
  });
}

function displayResults(vin, vehicleData, recallData){
  const response=document.getElementById('vin-response');
  const wmi=vin.substring(0,3);
  
  // Parse vehicle information
  const results = vehicleData.Results || [];
  let vehicleInfo = {};
  results.forEach(item => {
    if(item.Value && item.Value !== '' && item.Value !== 'Not Applicable'){
      vehicleInfo[item.Variable] = item.Value;
    }
  });

  // Determine manufacturer and recall URL
  let recallUrl='';
  let manufacturer='';

  // Ford
  if(wmi.startsWith('1F') || wmi.startsWith('3F')){
    recallUrl='https://owner.ford.com/tools/account/maintenance/recalls.html';
    manufacturer='Ford';
  }
  // GM (Chevrolet, GMC, Cadillac, Buick)
  else if(wmi.startsWith('1G') || wmi.startsWith('3G') || wmi.startsWith('2G')){
    recallUrl='https://my.gm.com/recalls';
    manufacturer='GM';
  }
  // Chrysler/Stellantis (Dodge, Ram, Jeep, Chrysler)
  else if(wmi.startsWith('1C') || wmi.startsWith('3C') || wmi.startsWith('2C')){
    recallUrl='https://recalls.mopar.com/';
    manufacturer='Chrysler/Stellantis';
  }
  // Toyota
  else if(wmi.startsWith('4T') || wmi.startsWith('5T') || wmi.startsWith('JT')){
    recallUrl='https://www.toyota.com/recall';
    manufacturer='Toyota';
  }
  // Honda
  else if(wmi.startsWith('1H') || wmi.startsWith('2H') || wmi.startsWith('JH')){
    recallUrl='https://owners.honda.com/service-maintenance/recalls';
    manufacturer='Honda';
  }
  // Nissan
  else if(wmi.startsWith('1N') || wmi.startsWith('3N') || wmi.startsWith('JN')){
    recallUrl='https://www.nissan-recalls.com/';
    manufacturer='Nissan';
  }
  // Hyundai
  else if(wmi.startsWith('KM') || wmi.startsWith('5N')){
    recallUrl='https://autoservice.hyundaiusa.com/campaignhome';
    manufacturer='Hyundai';
  }
  // Kia
  else if(wmi.startsWith('KN')){
    recallUrl='https://owners.kia.com/us/en/safety-recall.html';
    manufacturer='Kia';
  }
  // Subaru
  else if(wmi.startsWith('4S') || wmi.startsWith('JF')){
    recallUrl='https://www.subaru.com/vehicle-recalls.html';
    manufacturer='Subaru';
  }
  // Mazda
  else if(wmi.startsWith('JM')){
    recallUrl='https://www.mazdausa.com/owners/recalls';
    manufacturer='Mazda';
  }
  // Volkswagen
  else if(wmi.startsWith('WV') || wmi.startsWith('3V')){
    recallUrl='https://www.vw.com/recalls/';
    manufacturer='Volkswagen';
  }
  // BMW
  else if(wmi.startsWith('WB') || wmi.startsWith('5U')){
    recallUrl='https://www.bmwusa.com/recall.html';
    manufacturer='BMW';
  }
  // Mercedes
  else if(wmi.startsWith('WD') || wmi.startsWith('4J')){
    recallUrl='https://www.mbusa.com/en/owners/recalls';
    manufacturer='Mercedes-Benz';
  }
  else{
    recallUrl='https://www.nhtsa.gov/recalls';
    manufacturer=vehicleInfo.Make || 'Unknown';
  }
  
  let html='<h3>üìã VIN: '+vin+'</h3>';
  
  // Display vehicle information
  html+='<div class="vehicle-info">';
  html+='<strong>üöó Vehicle Information</strong><br>';
  if(vehicleInfo.ModelYear) html+='<strong>Year:</strong> '+vehicleInfo.ModelYear+'<br>';
  if(vehicleInfo.Make) html+='<strong>Make:</strong> '+vehicleInfo.Make+'<br>';
  if(vehicleInfo.Model) html+='<strong>Model:</strong> '+vehicleInfo.Model+'<br>';
  if(vehicleInfo.Trim) html+='<strong>Trim:</strong> '+vehicleInfo.Trim+'<br>';
  if(vehicleInfo.BodyClass) html+='<strong>Body Type:</strong> '+vehicleInfo.BodyClass+'<br>';
  if(vehicleInfo.EngineModel) html+='<strong>Engine:</strong> '+vehicleInfo.EngineModel+'<br>';
  if(vehicleInfo.DisplacementL) html+='<strong>Displacement:</strong> '+vehicleInfo.DisplacementL+'L<br>';
  if(vehicleInfo.DriveType) html+='<strong>Drive Type:</strong> '+vehicleInfo.DriveType+'<br>';
  if(vehicleInfo.TransmissionStyle) html+='<strong>Transmission:</strong> '+vehicleInfo.TransmissionStyle+'<br>';
  html+='</div>';
  
  // Check if recalls exist
  const recalls=recallData.results || [];
  
  if(recalls.length===0){
    html+='<div class="no-recall">‚úÖ NO ACTIVE RECALLS FOUND</div>';
    html+='<div style="margin-top:12px;font-size:.85em;color:#aaa;text-align:center">Great news! No open recalls for this vehicle.</div>';
  }else{
    html+='<div class="warning">‚ö†Ô∏è '+recalls.length+' ACTIVE RECALL'+(recalls.length>1?'S':'')+' FOUND</div>';
    
    recalls.forEach((recall,idx)=>{
      html+='<div class="recall-item">';
      html+='<strong style="color:#ff7f2a;font-size:1.05em">üî¥ Recall #'+(recall.NHTSACampaignNumber || 'N/A')+'</strong><br><br>';
      html+='<strong>Component:</strong> '+(recall.Component || 'N/A')+'<br>';
      html+='<strong>Issue:</strong> '+(recall.Summary || 'N/A')+'<br>';
      if(recall.Consequence){
        html+='<strong>Risk:</strong> '+recall.Consequence+'<br>';
      }
      if(recall.Remedy){
        html+='<strong>The Fix:</strong> '+recall.Remedy+'<br>';
      }
      if(recall.ReportReceivedDate){
        html+='<strong>Reported:</strong> '+recall.ReportReceivedDate+'<br>';
      }
      html+='</div>';
    });
  }
  
  // Add action buttons
  html+='<div class="button-row">';
  html+='<button onclick="copyVIN(\''+vin+'\')">üìã Copy VIN</button>';
  if(manufacturer!=='Unknown'){
    html+='<button onclick="goToOEM(\''+recallUrl+'\')">üè≠ '+manufacturer+' Site</button>';
  }
  html+='</div>';
  
  html+='<div class="button-row">';
  html+='<button onclick="goToCarfax(\''+vin+'\')">üìä CarFax Report</button>';
  html+='<button onclick="goToNHTSA(\''+vin+'\')">üîç NHTSA Details</button>';
  html+='</div>';
  
  html+='<div style="margin-top:8px;font-size:.75em;color:#888;text-align:center">Data provided by NHTSA ‚Ä¢ Always verify with manufacturer</div>';
  
  response.innerHTML=html;
  
  // Auto-copy VIN to clipboard when results load
  navigator.clipboard.writeText(vin).then(()=>{
    console.log('VIN auto-copied to clipboard');
  }).catch(()=>{
    console.log('Auto-copy failed');
  });
  
  // Add close button
  const closeBtn = document.createElement('div');
  closeBtn.className = 'vin-close-btn';
  closeBtn.innerHTML = '‚úï';
  closeBtn.onclick = function(e){
    e.stopPropagation();
    toggleVINResults();
  };
  response.insertBefore(closeBtn, response.firstChild);
  
  // Make collapsed box clickable to expand
  response.onclick = function(){
    if(response.classList.contains('collapsed')){
      response.classList.remove('collapsed');
    }
  };
}
}

function copyVIN(vin){
  navigator.clipboard.writeText(vin).then(()=>{
    alert('‚úÖ VIN copied to clipboard!\n\n(Note: VIN was already auto-copied when results loaded)\n\nYou can now paste it on the manufacturer\'s recall page.');
  }).catch(()=>{
    alert('VIN: '+vin+'\n\nPlease copy this VIN manually.');
  });
}

function goToOEM(url){
  window.open(url,'_blank');
}

function goToCarfax(vin){
  // TODO: Replace this URL with your CarFax affiliate link when you get it
  // Example: window.open('https://www.carfax.com/vehicle/'+vin+'?affiliate=YOUR_AFFILIATE_ID','_blank');
  window.open('https://www.carfax.com/vehicle/'+vin,'_blank');
}

function goToNHTSA(vin){
  window.open('https://www.nhtsa.gov/recalls?vin='+vin,'_blank');
}

function toggleVINResults(){
  const response = document.getElementById('vin-response');
  response.classList.add('collapsed');
}
</script>

</body>
</html>
